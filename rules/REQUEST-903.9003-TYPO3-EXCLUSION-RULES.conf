# ------------------------------------------------------------------------
# OWASP ModSecurity Core Rule Set ver.3.0.0
# Copyright (c) 2006-2016 Trustwave and contributors. All rights reserved.
#
# The OWASP ModSecurity Core Rule Set is distributed under
# Apache Software License (ASL) version 2
# Please see the enclosed LICENSE file for full details.
# ------------------------------------------------------------------------

# These exclusions remedy false positives in a default Typo3 install.
# The exclusions are only active if crs_exclusions_typo3=1 is set.
# See rule 900130 in crs-setup.conf.example for instructions.

SecRule &TX:crs_exclusions_typo3|TX:crs_exclusions_typo3 "@eq 0" \
	"id:9003000,\
	phase:1,\
	t:none,\
	nolog,\
	pass,\
	skipAfter:END-TYPO3"

SecRule &TX:crs_exclusions_typo3|TX:crs_exclusions_typo3 "@eq 0" \
	"id:9003001,\
	phase:2,\
	t:none,\
	nolog,\
	pass,\
	skipAfter:END-TYPO3"


#
# -=[ Typo3 Front-End ]=-
#


# [ Password ]
#
# Disable the CRS completely for all occurrences of passwords.
#
SecRule REQUEST_FILENAME "@endsWith /typo3/sysext/install/Start/Install.php" \
        "id:9003110,\
        phase:2,\
        nolog,\
        pass,\
        ctl:ruleRemoveTargetByTag=CRS;ARGS:install[values][password]"


#
# [ Installation: Various ]
#
# ModSec Rule Exclusion: 942370 : Detects classic SQLi probings 2/2
# ModSec Rule Exclusion: 942430 : Restr. SQL Char Anomaly Detection (12)

SecRule REQUEST_URI "@endsWith /typo3/index.php" \
        "id:9003200,\
        phase:2,\
        nolog,\
        pass,\
        ctl:ruleRemoveTargetById=942370;ARGS:icon,\
        ctl:ruleRemoveTargetById=942430;ARGS:icon"



SecMarker END-TYPO3
